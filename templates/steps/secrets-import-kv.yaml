parameters:
- name: serviceConnection
  type: string
- name: appKeyVault
  type: string  
- name: workingDirectory
  type: string
- name: PSHelperDirectory
  type: string 
- name: secretName
  type: string 
steps:
  - task: AzureCLI@2
    displayName: '${{ parameters.secretName }}'
    env:
      secretName: ${{ parameters.secretName }}
      secretValue: $(${{ parameters.secretName }})
    inputs:
      azureSubscription: ${{ parameters.serviceConnection }}
      scriptType: pscore
      scriptLocation: scriptPath
      scriptPath: '$(Pipeline.Workspace)/s/ADO-Pipeline-Common/templates/powershell/build/ImportSecretsToKV.ps1'
      arguments: -KeyVault ${{ parameters.appKeyVault }} -PSHelperDirectory ${{ parameters.PSHelperDirectory }}
      addSpnToEnvironment: true
      failOnStandardError: false
      workingDirectory: '$(Pipeline.Workspace)/s'
