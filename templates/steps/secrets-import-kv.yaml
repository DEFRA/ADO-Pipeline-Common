parameters:
- name: environmentObj
  type: object
- name: appDeployConfig
  type: object
  default: null
- name: workingDirectory
  type: string
- name: serviceName
  type: string
- name: PSHelperDirectory
  type: string 
- name: secretName
  type: string 
steps:
  - task: AzureCLI@2
    displayName: 'import secrets ${{ parameters.secretName }}'
    env:
      secretName: ${{ parameters.secretName }}
      secretValue: $(${{ parameters.secretName }})
    inputs:
      azureSubscription: ${{ parameters.environmentObj.serviceConnection }}
      scriptType: pscore
      scriptLocation: inlineScript
      inlineScript: |
        $secureSecretvalue = ConvertTo-SecureString $env:secretValue -AsPlainText -Force                                        
        az keyvault secret set --name $ENV:secretName --vault-name ${{ parameters.environmentObj.appKeyVault }} --value $secureSecretvalue
      addSpnToEnvironment: true

        
